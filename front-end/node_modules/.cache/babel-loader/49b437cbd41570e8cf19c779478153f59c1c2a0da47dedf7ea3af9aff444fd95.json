{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nexport const signInUser = createAsyncThunk('signInUser', async body => {\n  localStorage.removeItem('token');\n  const auth = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    body: JSON.stringify(body),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const authData = await auth.json();\n  return authData;\n});\nconst initialState = {\n  loading: false,\n  status: 0,\n  isAuth: false,\n  remember: false\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    remember: (state, action) => {\n      console.log(action.payload);\n      state.remember = action.payload;\n    },\n    logout: () => {\n      localStorage.removeItem('token');\n      localStorage.setItem('token', undefined);\n      localStorage.clear();\n    }\n  },\n  extraReducers: {\n    [signInUser.pending]: state => {\n      localStorage.removeItem('status');\n      console.log(\"auth pending...\");\n      state.loading = true;\n      state.status = 0;\n    },\n    [signInUser.fulfilled]: (state, action) => {\n      state.loading = false;\n      switch (action.payload.status) {\n        case 200:\n          console.log(\"auth fulfilled\");\n          localStorage.setItem(\"token\", action.payload.body.token);\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          state.isAuth = true;\n          break;\n        case 400:\n          console.log(\"Invalid id or password\");\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          break;\n        default:\n          console.log(\"uknown error\");\n          break;\n      }\n    },\n    [signInUser.rejected]: state => {\n      state.loading = false;\n      console.log(\"auth rejected!\");\n      localStorage.setItem(\"status\", 404);\n      state.status = 404;\n    }\n  }\n});\nexport const authSliceReducer = authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","signInUser","body","localStorage","removeItem","auth","fetch","method","JSON","stringify","headers","authData","json","initialState","loading","status","isAuth","remember","authSlice","name","reducers","state","action","console","log","payload","logout","setItem","undefined","clear","extraReducers","pending","fulfilled","token","rejected","authSliceReducer","reducer"],"sources":["/home/mehdi/Documents/nammi/src/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const signInUser = createAsyncThunk('signInUser', async(body) => {\n    localStorage.removeItem('token')\n    const auth = await fetch (\"http://localhost:3001/api/v1/user/login\", {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: { \"Content-Type\": \"application/json\" },\n        })\n        const authData = await auth.json()\n        return authData;\n})\n\nconst initialState = {\n    loading: false,\n    status: 0,\n    isAuth: false,\n    remember: false\n}\n\n\nconst authSlice = createSlice({\n    name: \"auth\",\n    initialState,\n    reducers: {\n        remember: (state, action) => {\n            console.log(action.payload)\n            state.remember = action.payload\n        },\n        logout: () => {\n            localStorage.removeItem('token')\n            localStorage.setItem('token', undefined)\n            localStorage.clear();\n        }\n    },\n    extraReducers:{\n        [signInUser.pending]: (state) =>{\n            localStorage.removeItem('status')\n            console.log(\"auth pending...\")\n            state.loading = true\n            state.status = 0\n        },\n        [signInUser.fulfilled]: (state, action) =>{\n            state.loading = false\n            switch (action.payload.status){\n                case 200:\n                    console.log(\"auth fulfilled\");\n                    localStorage.setItem(\"token\", action.payload.body.token)\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    state.isAuth = true\n                    break;\n                case 400:\n                    console.log(\"Invalid id or password\");\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    break;\n                default:\n                    console.log(\"uknown error\")\n                    break\n            }\n        },\n        [signInUser.rejected]: (state) =>{\n            state.loading = false\n            console.log(\"auth rejected!\")\n            localStorage.setItem(\"status\", 404)\n            state.status = 404\n        }\n    }\n})\n\nexport const authSliceReducer = authSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}