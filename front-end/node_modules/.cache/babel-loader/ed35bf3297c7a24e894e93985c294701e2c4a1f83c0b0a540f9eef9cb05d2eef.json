{"ast":null,"code":"import { createSlice, createAsyncThunk, configureStore } from \"@reduxjs/toolkit\";\nconst initialState = {\n  msg: '',\n  loading: false,\n  error: '',\n  email: '',\n  firstName: '',\n  lastName: '',\n  id: '',\n  loading: false\n};\nconst getUserProfile = createAsyncThunk('getUserProfile', async token => {\n  const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\n    method: \"POST\",\n    headers: {\n      \"Authorization\": `Bearer ${token}`\n    }\n  });\n  const data = await response.json();\n  console.log(data);\n  return data;\n});\nexport const signInUser = createAsyncThunk('signInUser', async body => {\n  const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    body: JSON.stringify(body),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const data = await response.json();\n  localStorage.setItem(\"token\", data.body.token);\n  getUserProfile(data.body.token);\n  return data;\n});\nexport const userSlice = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [signInUser.pending]: state => {\n      console.log(\"loading ...\");\n      state.loading = true;\n    },\n    [signInUser.fulfilled]: (state, action) => {\n      console.log(\"fullfiled ...\");\n      state.loading = false;\n      state.msg = action.payload.message;\n    },\n    [signInUser.rejected]: (state, action) => {\n      console.log(\"rejected ...\");\n      state.loading = false;\n      state.error = action.error.message;\n    },\n    [getUserProfile.pending]: state => {\n      console.log(\"User\");\n      state.loading = true;\n    },\n    [getUserProfile.fulfilled]: (state, action) => {\n      state.loading = false;\n      state.email = action.payload.email;\n      state.firstName = action.payload.firstName;\n      state.lastName = action.payload.lastName;\n    },\n    [getUserProfile.rejected]: state => {\n      state.loading = false;\n      state.email = null;\n      state.firstName = null;\n      state.lastName = null;\n    }\n  }\n});\nexport const store = configureStore({\n  reducer: {\n    user: userSlice.reducer\n  }\n});","map":{"version":3,"names":["createSlice","createAsyncThunk","configureStore","initialState","msg","loading","error","email","firstName","lastName","id","getUserProfile","token","response","fetch","method","headers","data","json","console","log","signInUser","body","JSON","stringify","localStorage","setItem","userSlice","name","reducers","extraReducers","pending","state","fulfilled","action","payload","message","rejected","store","reducer","user"],"sources":["/home/mehdi/Documents/nammi/src/features/userSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk, configureStore } from \"@reduxjs/toolkit\";\n\nconst initialState = {\n    msg: '',\n    loading: false,\n    error:'',\n    email: '',\n    firstName: '',\n    lastName: '',\n    id: '',\n    loading: false,\n}\n\nconst getUserProfile = createAsyncThunk('getUserProfile', async(token) => {\n    const response = await fetch (\"http://localhost:3001/api/v1/user/profile\", {\n        method: \"POST\",\n        headers: { \"Authorization\" : `Bearer ${token}`},\n        })\n        const data = await response.json()\n        console.log(data)\n        return data;\n   \n})\n\nexport const signInUser = createAsyncThunk('signInUser', async(body) => {\n    const response = await fetch (\"http://localhost:3001/api/v1/user/login\", {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: { \"Content-Type\": \"application/json\" },\n        })\n        const data = await response.json()\n        localStorage.setItem(\"token\", data.body.token)\n        getUserProfile(data.body.token);\n        return data;\n})\n\nexport const userSlice = createSlice({\n    name: 'user',\n    initialState,\n    reducers:{\n    },\n    extraReducers:{\n        [signInUser.pending]: (state) =>{\n            console.log(\"loading ...\")\n            state.loading = true\n        },\n        [signInUser.fulfilled]: (state, action) =>{  \n            console.log(\"fullfiled ...\")         \n            state.loading = false\n            state.msg = action.payload.message\n        },\n        [signInUser.rejected]: (state, action) =>{  \n            console.log(\"rejected ...\")          \n            state.loading = false\n            state.error = action.error.message\n        },\n        [getUserProfile.pending]: (state) =>{\n            console.log(\"User\")\n            state.loading = true\n        },\n        [getUserProfile.fulfilled]: (state, action) =>{           \n            state.loading = false\n            state.email = action.payload.email\n            state.firstName = action.payload.firstName\n            state.lastName = action.payload.lastName\n        },\n        [getUserProfile.rejected]: (state) =>{            \n            state.loading = false\n            state.email = null\n            state.firstName = null\n            state.lastName = null\n        }\n    }\n})\n\nexport const store = configureStore({\n    reducer: {\n        user: userSlice.reducer,\n    }\n})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}