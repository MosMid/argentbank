{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nexport const signInUser = createAsyncThunk('signInUser', async body => {\n  localStorage.removeItem('token');\n  const auth = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    body: JSON.stringify(body),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const authData = await auth.json();\n  return authData;\n});\nconst initialState = {\n  loading: false,\n  status: 0,\n  isAuth: false,\n  remember: null\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    remember: (state, action) => {\n      state.remember = action.payload;\n    },\n    logout: () => {\n      localStorage.clear();\n    }\n  },\n  extraReducers: {\n    [signInUser.pending]: state => {\n      localStorage.removeItem('status');\n      //console.log(\"auth pending...\")\n      state.loading = true;\n      state.status = 0;\n    },\n    [signInUser.fulfilled]: (state, action) => {\n      state.loading = false;\n      switch (action.payload.status) {\n        case 200:\n          //console.log(\"auth fulfilled\");\n          localStorage.setItem(\"token\", action.payload.body.token);\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          state.isAuth = true;\n          break;\n        case 400:\n          //console.log(\"Invalid id or password\");\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          break;\n        default:\n          //console.log(\"uknown error\")\n          break;\n      }\n    },\n    [signInUser.rejected]: state => {\n      state.loading = false;\n      //console.log(\"auth rejected!\")\n      localStorage.setItem(\"status\", 404);\n      state.status = 404;\n    }\n  }\n});\nexport const authSliceReducer = authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","signInUser","body","localStorage","removeItem","auth","fetch","method","JSON","stringify","headers","authData","json","initialState","loading","status","isAuth","remember","authSlice","name","reducers","state","action","payload","logout","clear","extraReducers","pending","fulfilled","setItem","token","rejected","authSliceReducer","reducer"],"sources":["/home/mehdi/Documents/nammi/src/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const signInUser = createAsyncThunk('signInUser', async(body) => {\n    localStorage.removeItem('token')\n    const auth = await fetch (\"http://localhost:3001/api/v1/user/login\", {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: { \"Content-Type\": \"application/json\" },\n        })\n        const authData = await auth.json()\n        return authData;\n})\n\nconst initialState = {\n    loading: false,\n    status: 0,\n    isAuth: false,\n    remember: null\n}\n\n\nconst authSlice = createSlice({\n    name: \"auth\",\n    initialState,\n    reducers: {\n        remember: (state, action) => {\n            state.remember = action.payload\n        },\n        logout: () => {\n            localStorage.clear();\n        }\n    },\n    extraReducers:{\n        [signInUser.pending]: (state) =>{\n            localStorage.removeItem('status')\n            //console.log(\"auth pending...\")\n            state.loading = true\n            state.status = 0\n        },\n        [signInUser.fulfilled]: (state, action) =>{\n            state.loading = false\n            switch (action.payload.status){\n                case 200:\n                    //console.log(\"auth fulfilled\");\n                    localStorage.setItem(\"token\", action.payload.body.token)\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    state.isAuth = true\n                    break;\n                case 400:\n                    //console.log(\"Invalid id or password\");\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    break;\n                default:\n                    //console.log(\"uknown error\")\n                    break\n            }\n        },\n        [signInUser.rejected]: (state) =>{\n            state.loading = false\n            //console.log(\"auth rejected!\")\n            localStorage.setItem(\"status\", 404)\n            state.status = 404\n        }\n    }\n})\n\nexport const authSliceReducer = authSlice.reducer"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAEhE,OAAO,MAAMC,UAAU,GAAGD,gBAAgB,CAAC,YAAY,EAAE,MAAME,IAAI,IAAK;EACpEC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;EAChC,MAAMC,IAAI,GAAG,MAAMC,KAAK,CAAE,yCAAyC,EAAE;IACjEC,MAAM,EAAE,MAAM;IACdL,IAAI,EAAEM,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC;IAC1BQ,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB;EAC9C,CAAC,CAAC;EACF,MAAMC,QAAQ,GAAG,MAAMN,IAAI,CAACO,IAAI,EAAE;EAClC,OAAOD,QAAQ;AACvB,CAAC,CAAC;AAEF,MAAME,YAAY,GAAG;EACjBC,OAAO,EAAE,KAAK;EACdC,MAAM,EAAE,CAAC;EACTC,MAAM,EAAE,KAAK;EACbC,QAAQ,EAAE;AACd,CAAC;AAGD,MAAMC,SAAS,GAAGnB,WAAW,CAAC;EAC1BoB,IAAI,EAAE,MAAM;EACZN,YAAY;EACZO,QAAQ,EAAE;IACNH,QAAQ,EAAE,CAACI,KAAK,EAAEC,MAAM,KAAK;MACzBD,KAAK,CAACJ,QAAQ,GAAGK,MAAM,CAACC,OAAO;IACnC,CAAC;IACDC,MAAM,EAAE,MAAM;MACVrB,YAAY,CAACsB,KAAK,EAAE;IACxB;EACJ,CAAC;EACDC,aAAa,EAAC;IACV,CAACzB,UAAU,CAAC0B,OAAO,GAAIN,KAAK,IAAI;MAC5BlB,YAAY,CAACC,UAAU,CAAC,QAAQ,CAAC;MACjC;MACAiB,KAAK,CAACP,OAAO,GAAG,IAAI;MACpBO,KAAK,CAACN,MAAM,GAAG,CAAC;IACpB,CAAC;IACD,CAACd,UAAU,CAAC2B,SAAS,GAAG,CAACP,KAAK,EAAEC,MAAM,KAAI;MACtCD,KAAK,CAACP,OAAO,GAAG,KAAK;MACrB,QAAQQ,MAAM,CAACC,OAAO,CAACR,MAAM;QACzB,KAAK,GAAG;UACJ;UACAZ,YAAY,CAAC0B,OAAO,CAAC,OAAO,EAAEP,MAAM,CAACC,OAAO,CAACrB,IAAI,CAAC4B,KAAK,CAAC;UACxDT,KAAK,CAACN,MAAM,GAAGO,MAAM,CAACC,OAAO,CAACR,MAAM;UACpCZ,YAAY,CAAC0B,OAAO,CAAC,QAAQ,EAAEP,MAAM,CAACC,OAAO,CAACR,MAAM,CAAC;UACrDM,KAAK,CAACL,MAAM,GAAG,IAAI;UACnB;QACJ,KAAK,GAAG;UACJ;UACAK,KAAK,CAACN,MAAM,GAAGO,MAAM,CAACC,OAAO,CAACR,MAAM;UACpCZ,YAAY,CAAC0B,OAAO,CAAC,QAAQ,EAAEP,MAAM,CAACC,OAAO,CAACR,MAAM,CAAC;UACrD;QACJ;UACI;UACA;MAAK;IAEjB,CAAC;IACD,CAACd,UAAU,CAAC8B,QAAQ,GAAIV,KAAK,IAAI;MAC7BA,KAAK,CAACP,OAAO,GAAG,KAAK;MACrB;MACAX,YAAY,CAAC0B,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC;MACnCR,KAAK,CAACN,MAAM,GAAG,GAAG;IACtB;EACJ;AACJ,CAAC,CAAC;AAEF,OAAO,MAAMiB,gBAAgB,GAAGd,SAAS,CAACe,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}