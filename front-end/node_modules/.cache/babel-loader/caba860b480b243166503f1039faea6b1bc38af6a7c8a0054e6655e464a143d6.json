{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nexport const signInUser = createAsyncThunk('signInUser', async body => {\n  localStorage.removeItem('token');\n  const auth = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    body: JSON.stringify(body),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const authData = await auth.json();\n  return authData;\n});\nconst initialState = {\n  loading: false,\n  status: 0,\n  isAuth: false\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    logout: state => {\n      state.isAuth = false;\n      localStorage.removeItem('token');\n      localStorage.setItem('token', undefined);\n    }\n  },\n  extraReducers: {\n    [signInUser.pending]: state => {\n      localStorage.removeItem('status');\n      console.log(\"auth pending...\");\n      state.loading = true;\n      state.status = 0;\n    },\n    [signInUser.fulfilled]: (state, action) => {\n      state.loading = false;\n      switch (action.payload.status) {\n        case 200:\n          console.log(\"auth fulfilled\");\n          localStorage.setItem(\"token\", action.payload.body.token);\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          state.isAuth = true;\n          break;\n        case 400:\n          console.log(\"Invalid id or password\");\n          state.status = action.payload.status;\n          localStorage.setItem(\"status\", action.payload.status);\n          break;\n      }\n    },\n    [signInUser.rejected]: state => {\n      state.loading = false;\n      console.log(\"auth rejected!\");\n      localStorage.setItem(\"status\", 404);\n      state.status = 404;\n    }\n  }\n});\nexport const authSliceReducer = authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","signInUser","body","localStorage","removeItem","auth","fetch","method","JSON","stringify","headers","authData","json","initialState","loading","status","isAuth","authSlice","name","reducers","logout","state","setItem","undefined","extraReducers","pending","console","log","fulfilled","action","payload","token","rejected","authSliceReducer","reducer"],"sources":["/home/mehdi/Documents/nammi/src/features/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const signInUser = createAsyncThunk('signInUser', async(body) => {\n    localStorage.removeItem('token')\n    const auth = await fetch (\"http://localhost:3001/api/v1/user/login\", {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: { \"Content-Type\": \"application/json\" },\n        })\n        const authData = await auth.json()\n        return authData;\n})\n\nconst initialState = {\n    loading: false,\n    status: 0,\n    isAuth: false\n}\n\n\nconst authSlice = createSlice({\n    name: \"auth\",\n    initialState,\n    reducers: {\n        logout: (state) => {\n            state.isAuth = false\n            localStorage.removeItem('token')\n            localStorage.setItem('token', undefined)\n        }\n    },\n    extraReducers:{\n        [signInUser.pending]: (state) =>{\n            localStorage.removeItem('status')\n            console.log(\"auth pending...\")\n            state.loading = true\n            state.status = 0\n        },\n        [signInUser.fulfilled]: (state, action) =>{\n            state.loading = false\n            switch (action.payload.status){\n                case 200:\n                    console.log(\"auth fulfilled\");\n                    localStorage.setItem(\"token\", action.payload.body.token)\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    state.isAuth = true\n                    break;\n                case 400:\n                    console.log(\"Invalid id or password\");\n                    state.status = action.payload.status\n                    localStorage.setItem(\"status\", action.payload.status)\n                    break;\n            }\n        },\n        [signInUser.rejected]: (state) =>{\n            state.loading = false\n            console.log(\"auth rejected!\")\n            localStorage.setItem(\"status\", 404)\n            state.status = 404\n        }\n    }\n})\n\nexport const authSliceReducer = authSlice.reducer"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAEhE,OAAO,MAAMC,UAAU,GAAGD,gBAAgB,CAAC,YAAY,EAAE,MAAME,IAAI,IAAK;EACpEC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;EAChC,MAAMC,IAAI,GAAG,MAAMC,KAAK,CAAE,yCAAyC,EAAE;IACjEC,MAAM,EAAE,MAAM;IACdL,IAAI,EAAEM,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC;IAC1BQ,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB;EAC9C,CAAC,CAAC;EACF,MAAMC,QAAQ,GAAG,MAAMN,IAAI,CAACO,IAAI,EAAE;EAClC,OAAOD,QAAQ;AACvB,CAAC,CAAC;AAEF,MAAME,YAAY,GAAG;EACjBC,OAAO,EAAE,KAAK;EACdC,MAAM,EAAE,CAAC;EACTC,MAAM,EAAE;AACZ,CAAC;AAGD,MAAMC,SAAS,GAAGlB,WAAW,CAAC;EAC1BmB,IAAI,EAAE,MAAM;EACZL,YAAY;EACZM,QAAQ,EAAE;IACNC,MAAM,EAAGC,KAAK,IAAK;MACfA,KAAK,CAACL,MAAM,GAAG,KAAK;MACpBb,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;MAChCD,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEC,SAAS,CAAC;IAC5C;EACJ,CAAC;EACDC,aAAa,EAAC;IACV,CAACvB,UAAU,CAACwB,OAAO,GAAIJ,KAAK,IAAI;MAC5BlB,YAAY,CAACC,UAAU,CAAC,QAAQ,CAAC;MACjCsB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAC9BN,KAAK,CAACP,OAAO,GAAG,IAAI;MACpBO,KAAK,CAACN,MAAM,GAAG,CAAC;IACpB,CAAC;IACD,CAACd,UAAU,CAAC2B,SAAS,GAAG,CAACP,KAAK,EAAEQ,MAAM,KAAI;MACtCR,KAAK,CAACP,OAAO,GAAG,KAAK;MACrB,QAAQe,MAAM,CAACC,OAAO,CAACf,MAAM;QACzB,KAAK,GAAG;UACJW,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAC7BxB,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEO,MAAM,CAACC,OAAO,CAAC5B,IAAI,CAAC6B,KAAK,CAAC;UACxDV,KAAK,CAACN,MAAM,GAAGc,MAAM,CAACC,OAAO,CAACf,MAAM;UACpCZ,YAAY,CAACmB,OAAO,CAAC,QAAQ,EAAEO,MAAM,CAACC,OAAO,CAACf,MAAM,CAAC;UACrDM,KAAK,CAACL,MAAM,GAAG,IAAI;UACnB;QACJ,KAAK,GAAG;UACJU,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;UACrCN,KAAK,CAACN,MAAM,GAAGc,MAAM,CAACC,OAAO,CAACf,MAAM;UACpCZ,YAAY,CAACmB,OAAO,CAAC,QAAQ,EAAEO,MAAM,CAACC,OAAO,CAACf,MAAM,CAAC;UACrD;MAAM;IAElB,CAAC;IACD,CAACd,UAAU,CAAC+B,QAAQ,GAAIX,KAAK,IAAI;MAC7BA,KAAK,CAACP,OAAO,GAAG,KAAK;MACrBY,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;MAC7BxB,YAAY,CAACmB,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC;MACnCD,KAAK,CAACN,MAAM,GAAG,GAAG;IACtB;EACJ;AACJ,CAAC,CAAC;AAEF,OAAO,MAAMkB,gBAAgB,GAAGhB,SAAS,CAACiB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}