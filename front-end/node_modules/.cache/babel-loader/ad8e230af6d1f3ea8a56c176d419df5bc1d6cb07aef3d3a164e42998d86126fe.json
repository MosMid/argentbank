{"ast":null,"code":"import { createSlice, createAsyncThunk, configureStore } from \"@reduxjs/toolkit\";\nconst initialState = {\n  msg: '',\n  error: '',\n  message: '',\n  id: '',\n  email: '',\n  loading: false\n};\n\n/*export const getUserProfile = createAsyncThunk('getUserProfile', async() => {\n    const response = await fetch (\"http://localhost:3001/api/v1/user/profile\", {\n        method: \"POST\",\n        headers: { \"Authorization\" : `Bearer ${localStorage.getItem(\"token\")}`},\n        })\n        const data = await response.json()\n        console.log(\"data\")\n        return data;\n   \n})*/\n\nexport const signInUser = createAsyncThunk('signInUser', async body => {\n  const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    body: JSON.stringify(body),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  let data = await response.json();\n  localStorage.setItem(\"token\", data.body.token);\n  //console.log(data.body.token)\n  const userResponse = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\n    method: \"POST\",\n    headers: {\n      \"Authorization\": `Bearer ${data.body.token}`\n    }\n  });\n  data = await userResponse.json();\n  //console.log(dato)\n  const token = localStorage.getItem(\"token\");\n  //console.log(token)\n  return data;\n});\nexport const userSlice = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [signInUser.pending]: state => {\n      console.log(\"loading ...\");\n    },\n    [signInUser.fulfilled]: (state, action) => {\n      console.log(\"fullfiled ...\");\n      state.msg = action.payload.message;\n      state.loading = false;\n      state.email = action.payload.body.firstName;\n      state.id = action.payload.body.lastName;\n    },\n    [signInUser.rejected]: (state, action) => {\n      console.log(\"rejected ...\");\n      state.error = action.error.message;\n    }\n  }\n});\nexport const store = configureStore({\n  reducer: {\n    user: userSlice.reducer\n  }\n});","map":{"version":3,"names":["createSlice","createAsyncThunk","configureStore","initialState","msg","error","message","id","email","loading","signInUser","body","response","fetch","method","JSON","stringify","headers","data","json","localStorage","setItem","token","userResponse","getItem","userSlice","name","reducers","extraReducers","pending","state","console","log","fulfilled","action","payload","firstName","lastName","rejected","store","reducer","user"],"sources":["/home/mehdi/Documents/nammi/src/features/userSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk, configureStore } from \"@reduxjs/toolkit\";\n\nconst initialState = {\n    msg: '',\n    error:'',\n    message: '',\n    id: '',\n    email: '',\n    loading: false,\n}\n\n/*export const getUserProfile = createAsyncThunk('getUserProfile', async() => {\n    const response = await fetch (\"http://localhost:3001/api/v1/user/profile\", {\n        method: \"POST\",\n        headers: { \"Authorization\" : `Bearer ${localStorage.getItem(\"token\")}`},\n        })\n        const data = await response.json()\n        console.log(\"data\")\n        return data;\n   \n})*/\n\nexport const signInUser = createAsyncThunk('signInUser', async(body) => {\n    const response = await fetch (\"http://localhost:3001/api/v1/user/login\", {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: { \"Content-Type\": \"application/json\" },\n        })\n        let data = await response.json()\n        localStorage.setItem(\"token\", data.body.token)\n        //console.log(data.body.token)\n        const userResponse = await fetch (\"http://localhost:3001/api/v1/user/profile\", {\n        method: \"POST\",\n        headers: { \"Authorization\" : `Bearer ${data.body.token}`},\n        })\n        data = await userResponse.json()\n        //console.log(dato)\n        const token = localStorage.getItem(\"token\")\n        //console.log(token)\n        return data;\n})\n\nexport const userSlice = createSlice({\n    name: 'user',\n    initialState,\n    reducers:{\n    },\n    extraReducers:{\n        [signInUser.pending]: (state) =>{\n            console.log(\"loading ...\")\n        },\n        [signInUser.fulfilled]: (state, action) =>{  \n            console.log(\"fullfiled ...\")         \n            state.msg = action.payload.message\n            state.loading = false\n            state.email = action.payload.body.firstName\n            state.id = action.payload.body.lastName\n        },\n        [signInUser.rejected]: (state, action) =>{  \n            console.log(\"rejected ...\")          \n            state.error = action.error.message\n        }\n    }\n})\n\nexport const store = configureStore({\n    reducer: {\n        user: userSlice.reducer,\n    }\n})"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,EAAEC,cAAc,QAAQ,kBAAkB;AAEhF,MAAMC,YAAY,GAAG;EACjBC,GAAG,EAAE,EAAE;EACPC,KAAK,EAAC,EAAE;EACRC,OAAO,EAAE,EAAE;EACXC,EAAE,EAAE,EAAE;EACNC,KAAK,EAAE,EAAE;EACTC,OAAO,EAAE;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,UAAU,GAAGT,gBAAgB,CAAC,YAAY,EAAE,MAAMU,IAAI,IAAK;EACpE,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,yCAAyC,EAAE;IACrEC,MAAM,EAAE,MAAM;IACdH,IAAI,EAAEI,IAAI,CAACC,SAAS,CAACL,IAAI,CAAC;IAC1BM,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB;EAC9C,CAAC,CAAC;EACF,IAAIC,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,EAAE;EAChCC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,IAAI,CAACP,IAAI,CAACW,KAAK,CAAC;EAC9C;EACA,MAAMC,YAAY,GAAG,MAAMV,KAAK,CAAE,2CAA2C,EAAE;IAC/EC,MAAM,EAAE,MAAM;IACdG,OAAO,EAAE;MAAE,eAAe,EAAI,UAASC,IAAI,CAACP,IAAI,CAACW,KAAM;IAAC;EACxD,CAAC,CAAC;EACFJ,IAAI,GAAG,MAAMK,YAAY,CAACJ,IAAI,EAAE;EAChC;EACA,MAAMG,KAAK,GAAGF,YAAY,CAACI,OAAO,CAAC,OAAO,CAAC;EAC3C;EACA,OAAON,IAAI;AACnB,CAAC,CAAC;AAEF,OAAO,MAAMO,SAAS,GAAGzB,WAAW,CAAC;EACjC0B,IAAI,EAAE,MAAM;EACZvB,YAAY;EACZwB,QAAQ,EAAC,CACT,CAAC;EACDC,aAAa,EAAC;IACV,CAAClB,UAAU,CAACmB,OAAO,GAAIC,KAAK,IAAI;MAC5BC,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC9B,CAAC;IACD,CAACtB,UAAU,CAACuB,SAAS,GAAG,CAACH,KAAK,EAAEI,MAAM,KAAI;MACtCH,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;MAC5BF,KAAK,CAAC1B,GAAG,GAAG8B,MAAM,CAACC,OAAO,CAAC7B,OAAO;MAClCwB,KAAK,CAACrB,OAAO,GAAG,KAAK;MACrBqB,KAAK,CAACtB,KAAK,GAAG0B,MAAM,CAACC,OAAO,CAACxB,IAAI,CAACyB,SAAS;MAC3CN,KAAK,CAACvB,EAAE,GAAG2B,MAAM,CAACC,OAAO,CAACxB,IAAI,CAAC0B,QAAQ;IAC3C,CAAC;IACD,CAAC3B,UAAU,CAAC4B,QAAQ,GAAG,CAACR,KAAK,EAAEI,MAAM,KAAI;MACrCH,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;MAC3BF,KAAK,CAACzB,KAAK,GAAG6B,MAAM,CAAC7B,KAAK,CAACC,OAAO;IACtC;EACJ;AACJ,CAAC,CAAC;AAEF,OAAO,MAAMiC,KAAK,GAAGrC,cAAc,CAAC;EAChCsC,OAAO,EAAE;IACLC,IAAI,EAAEhB,SAAS,CAACe;EACpB;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}